## Django 일기_5번째 이야기

#### 1.  movies app 생성 후 Model 만들기

- `Genre` 모델과 `Movie` 모델을 만들고 관리자 등록을 했습니다.

- `Movie` 모델에는 좋아요 기능을 M:N으로 구현하기 위한 like_users 필드를 추가로 생성했습니다.

- 두가지 테이블에 관리자가 생성, 수정, 삭제가 가능하게 했습니다.

- `Movie` 모델에 poster_path 필드의 이미지 url을 가져오기 위해서 views.py와 html에서 2가지 방식으로 구현해 보았습니다.

- accounts app에서 User 모델을 만들어 사용자 관리 기능을 구현했습니다.

  

#### 2. Data seeding

- Movies app 내 Model을 만들고 migrate를 진행했습니다.

- 그리고 JSON 파일을 끌어온 후 아래와 같이 명령어를 입력하여 만들어진 테이블의 필드명에 맞게 데이터를 저장했습니다.

  ```
  python manage.py loaddata moviedata.json
  ```

  

#### 3. AJAX 요청 구현

- 영화 '좋아요'를 비동기로 처리하기 위해 javascript를 활용했습니다.

- Movie_detail 페이지에서 axios.get을 활용해 .then에서 202 status가 나왔을 때 처리를 해주고, 에러가 나오면 .catch에서 err를 출력하게 했습니다.

- 이미 좋아요를 했다면, 좋아요 취소를하고 기존에 좋아요를 하지 않았다면, 좋아요를 할 수 있게 했습니다.

- 이때 좋아요 버튼이 바뀔 때 페이지가 새로고침 돼지 않습니다.

- 아래에는 좋아요의 합계를 출력해주었습니다.

- 좋아요는 인증된 사용자만(로그인 했을 때) 작동하는 기능으로 설정해주었기 때문에, 만약 로그인 하지 않았다면, 알림 메세지를 띄워 로그인을 유도하였습니다.

  

#### 4. 영화 추천서비스

- 알고리즘구현
  - 좋아요 한 영화들의 장르를 뽑아서 내림차순으로 정렬 후 그 중 가장 높은 개수의 장르를 most_liked_genre 변수에 담았습니다.
  - 그리고 `Genre` 모델에서 해당 장르를 가지고 있는 장르들의 제목을 가져왔습니다.
  - `Movie` 모델에 있는 테이블에서 해당 장르 이름을 가지고 있는 영화를 가져오고, 이를 다시 내림차순 정렬을해서 10개까지 뽑아봤습니다.
  - 이를 recommend_movies 변수에 담은 것을 context에 다시 담아서 추천 페이지로 넘겨주었습니다.
- 홈페이지 상단 `nav bar`에서 recommend를 누르면 추천 페이지로 이동합니다.
- 만약 영화 좋아요를 누르기 전이라면 메세지를 띄워서 먼저 좋아요를 하라고 유도합니다.
- 그리고 인증(로그인)된 유저만 사용한 가능한 서비스 이므로 `@login_required`를 사용했습니다.



#### 5. 메인페이지

- Paginator라이브러리를 활용하여 10개씩 잘라서 영화를 조회할 수 있게 구현했습니다.
- 화면 상단에 먼저 10개의의 영화를 보여주고 이를 overflow-x 스타일을 활용하여 가로 스크롤을 적용했습니다.
-  아래 `carousel`를 활용하여 영화를 하나씩 넘기면서 확인할 수 있습니다.
- 하단에 있는 페이지네이션을 활용해 페이지를 이동해가며 영화 전체 조회가 가능합니다.



<hr>

### 느낀점

- 오늘 프로젝트도 pair-programming을 하며 짝꿍에서 많은 도움을 받을 수 있었습니다.
- 처음 시작하면서 명세를 꼼꼼히 읽어보며 전체적인 로드맵을 명확히 짜볼 수 있었습니다.
- 영화추천 서비스라는 새로운 알고리즘 구현 기능을 고민해보며 만들 수 있어서 좋았습니다.
- 머리속으로만 생각했던 기능들을 실제로 실현 가능하게 할 수 있다는 점이 개발의 흥미로운 점이라고 생각합니다.
- 프로젝트를 한 주 한 주 진행하면서, 새로운 기능들을 추가하고 점점 확장시켜나가면서 많은 것을 배우며 경험하고 있습니다.
- 이렇게 모든 것들을 활용해서 종합선물세트가 될 마지막 프로젝트가 매우 기대가 됩니다.